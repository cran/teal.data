<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Dawid Kałędkowski" />


<title>Delayed Data Loading</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>



<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Delayed Data Loading</h1>
<h4 class="author">Dawid Kałędkowski</h4>
<h4 class="date">15.05.2022</h4>



<div id="overview" class="section level3">
<h3>Overview</h3>
<p><code>teal.data</code> provides several ways to include datasets into
shiny applications. Normally, one develops an application in such a way
that the data is available before the app starts. This always involves
passing <code>data.frame</code> objects using the
<code>cdisc_data</code> or <code>teal_data</code> functions to the shiny
application. This way of building an app is applicable if data is
physically available before the app is created.</p>
<p>Including data to the shiny app as <a href="https://shiny.rstudio.com/articles/scoping.html">global
objects</a> means that they will be fixed and won’t change throughout
the life of the application session.</p>
<p>The other possible scenario is that data may not be available during
the creation or initialization of the application. Such data would need
to be loaded by the shiny application after being initialized, which may
also involve the entering of user name and password credentials via
shiny UI components. Delayed data loading in applications involves
specifying metadata which stores all information needed to pull the data
from the right source. In delayed data loading applications, before the
main app loads the user is prompted with data loading UI.</p>
<p>This means that delayed data applications can be two-staged:</p>
<ol style="list-style-type: decimal">
<li>Data loading app</li>
<li>Main app</li>
</ol>
</div>
<div id="key-definitions" class="section level2">
<h2>Key definitions</h2>
<p>The following are general descriptions for the main classes of the
<code>teal.data</code> package.</p>
<ol style="list-style-type: decimal">
<li><p><code>TealDataset</code> contains physical data in the form of a
single <code>data.frame</code> plus reproducible code.</p></li>
<li><p><code>TealDatasetConnector</code> contains instructions to obtain
a single <code>TealDataset</code> object.</p></li>
<li><p><code>TealDataConnection</code> opens and closes connections
(with remote data sources).</p></li>
<li><p><code>TealDataConnector</code> contains arbitrary many
<code>TealDatasetConnector</code> objects and optionally one
<code>TealDataConnection</code> object.</p></li>
<li><p><code>TealData</code> contains arbitrary many
<code>TealDataset</code>, <code>TealDatasetConnector</code> and / or
<code>TealDataConnector</code> objects.</p></li>
</ol>
<p>With the exception of <code>TealDataConnection</code>, all of the
above classes have their CDISC equivalent, e.g. <code>TealData</code>
-&gt; <code>CDISCTealData</code>.</p>
</div>
<div id="creating-an-app" class="section level2">
<h2>Creating an app</h2>
<div id="callable" class="section level3">
<h3><code>Callable</code></h3>
<div id="callablefunction" class="section level4">
<h4><code>CallableFunction</code></h4>
<p>This class won’t be used often by the developers but it’s essential
for all connectors to store and execute R functions with the feature to
get the code to reproduce the function calls. In the example below an
object of class <code>CallableFunction</code> is created which runs
<code>synthetic_cdisc_dataset</code> function with arguments specified
by the user.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(teal.data)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(scda)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="co"># initialize object</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>fun <span class="ot">&lt;-</span> <span class="fu">callable_function</span>(<span class="at">fun =</span> synthetic_cdisc_dataset)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="co"># set arguments to function</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>fun<span class="sc">$</span><span class="fu">set_args</span>(<span class="fu">list</span>(<span class="at">dataset_name =</span> <span class="st">&quot;adsl&quot;</span>, <span class="at">name =</span> <span class="st">&quot;latest&quot;</span>))</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="co"># execute function with arguments set</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> fun<span class="sc">$</span><span class="fu">run</span>()</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(df, <span class="dv">3</span>)</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 3 × 44</span></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   STUDYID USUBJID     SUBJID SITEID   AGE AGEU  SEX   RACE  ETHNIC COUNTRY DTHFL</span></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   &lt;chr&gt;   &lt;chr&gt;       &lt;chr&gt;  &lt;chr&gt;  &lt;int&gt; &lt;fct&gt; &lt;fct&gt; &lt;fct&gt; &lt;fct&gt;  &lt;fct&gt;   &lt;fct&gt;</span></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1 AB12345 AB12345-CH… id-128 CHN-3     32 YEARS M     ASIAN NOT H… CHN     N    </span></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2 AB12345 AB12345-CH… id-262 CHN-15    35 YEARS M     BLAC… NOT H… CHN     N    </span></span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3 AB12345 AB12345-RU… id-378 RUS-3     30 YEARS F     ASIAN NOT H… RUS     N    </span></span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # … with 33 more variables: INVID &lt;chr&gt;, INVNAM &lt;chr&gt;, ARM &lt;fct&gt;, ARMCD &lt;fct&gt;,</span></span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; #   ACTARM &lt;fct&gt;, ACTARMCD &lt;fct&gt;, TRT01P &lt;fct&gt;, TRT01A &lt;fct&gt;, REGION1 &lt;fct&gt;,</span></span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; #   STRATA1 &lt;fct&gt;, STRATA2 &lt;fct&gt;, BMRKR1 &lt;dbl&gt;, BMRKR2 &lt;fct&gt;, ITTFL &lt;fct&gt;,</span></span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; #   SAFFL &lt;fct&gt;, BMEASIFL &lt;fct&gt;, BEP01FL &lt;fct&gt;, RANDDT &lt;date&gt;, TRTSDTM &lt;dttm&gt;,</span></span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; #   TRTEDTM &lt;dttm&gt;, EOSSTT &lt;fct&gt;, EOTSTT &lt;fct&gt;, EOSDT &lt;date&gt;, EOSDY &lt;int&gt;,</span></span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; #   DCSREAS &lt;fct&gt;, DTHDT &lt;date&gt;, DTHCAUS &lt;fct&gt;, DTHCAT &lt;fct&gt;, LDDTHELD &lt;int&gt;,</span></span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; #   LDDTHGR1 &lt;fct&gt;, LSTALVDT &lt;date&gt;, DTHADY &lt;int&gt;, study_duration_secs &lt;dbl&gt;</span></span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a><span class="co"># check reproducible code</span></span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(fun<span class="sc">$</span><span class="fu">get_call</span>())</span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; scda::synthetic_cdisc_dataset(dataset_name = &quot;adsl&quot;, name = &quot;latest&quot;)</span></span></code></pre></div>
<p>It’s also possible to execute the <code>fun$run()</code> function
with arguments added on the fly in a named <code>list</code>. Dynamic
arguments won’t be reflected in the reproducible code, which will have
consequences in other places - we will get back to this in later stages
of the documentation.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="co"># initialize object</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>fun <span class="ot">&lt;-</span> <span class="fu">callable_function</span>(<span class="at">fun =</span> synthetic_cdisc_dataset)</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="co"># add arguments on the fly</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> fun<span class="sc">$</span><span class="fu">run</span>(<span class="at">args =</span> <span class="fu">list</span>(<span class="at">dataset_name =</span> <span class="st">&quot;adae&quot;</span>, <span class="at">name =</span> <span class="st">&quot;latest&quot;</span>))</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(df, <span class="dv">3</span>)</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 3 × 74</span></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   STUDYID USUBJID     SUBJID SITEID   AGE AGEU  SEX   RACE  ETHNIC COUNTRY DTHFL</span></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   &lt;chr&gt;   &lt;chr&gt;       &lt;chr&gt;  &lt;chr&gt;  &lt;int&gt; &lt;fct&gt; &lt;fct&gt; &lt;fct&gt; &lt;fct&gt;  &lt;fct&gt;   &lt;fct&gt;</span></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1 AB12345 AB12345-BR… id-134 BRA-1     47 YEARS M     WHITE NOT H… BRA     N    </span></span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2 AB12345 AB12345-BR… id-134 BRA-1     47 YEARS M     WHITE NOT H… BRA     N    </span></span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3 AB12345 AB12345-BR… id-134 BRA-1     47 YEARS M     WHITE NOT H… BRA     N    </span></span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # … with 63 more variables: INVID &lt;chr&gt;, INVNAM &lt;chr&gt;, ARM &lt;fct&gt;, ARMCD &lt;fct&gt;,</span></span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; #   ACTARM &lt;fct&gt;, ACTARMCD &lt;fct&gt;, TRT01P &lt;fct&gt;, TRT01A &lt;fct&gt;, REGION1 &lt;fct&gt;,</span></span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; #   STRATA1 &lt;fct&gt;, STRATA2 &lt;fct&gt;, BMRKR1 &lt;dbl&gt;, BMRKR2 &lt;fct&gt;, ITTFL &lt;fct&gt;,</span></span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; #   SAFFL &lt;fct&gt;, BMEASIFL &lt;fct&gt;, BEP01FL &lt;fct&gt;, RANDDT &lt;date&gt;, TRTSDTM &lt;dttm&gt;,</span></span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; #   TRTEDTM &lt;dttm&gt;, EOSSTT &lt;fct&gt;, EOTSTT &lt;fct&gt;, EOSDT &lt;date&gt;, EOSDY &lt;int&gt;,</span></span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; #   DCSREAS &lt;fct&gt;, DTHDT &lt;date&gt;, DTHCAUS &lt;fct&gt;, DTHCAT &lt;fct&gt;, LDDTHELD &lt;int&gt;,</span></span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; #   LDDTHGR1 &lt;fct&gt;, LSTALVDT &lt;date&gt;, DTHADY &lt;int&gt;, study_duration_secs &lt;dbl&gt;, …</span></span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a><span class="co"># dynamic arguments not reflected in the call</span></span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(fun<span class="sc">$</span><span class="fu">get_call</span>())</span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; scda::synthetic_cdisc_dataset()</span></span></code></pre></div>
<p><code>CallableFunction</code> can also depend on other R objects as
the example function below depends on <code>ADSL</code>. The function
can be executed in specific environment where we can copy objects needed
to execute a call. To include objects in the function call, one has to
use <code>$assign_to_env()</code> to copy the object and
<code>$set_args(list(ADSL = as.name(ADSL)))</code> to link the object
with function argument.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>adsl_raw <span class="ot">&lt;-</span> <span class="fu">synthetic_cdisc_dataset</span>(<span class="at">dataset_name =</span> <span class="st">&quot;adsl&quot;</span>, <span class="at">name =</span> <span class="st">&quot;latest&quot;</span>)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>fun <span class="ot">&lt;-</span> <span class="fu">callable_function</span>(<span class="at">fun =</span> <span class="cf">function</span>(adsl) {</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>  adsl_2 <span class="ot">&lt;-</span> adsl</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>  adsl_2<span class="sc">$</span>new_col <span class="ot">&lt;-</span> <span class="cn">TRUE</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>  adsl_2</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a><span class="co"># copy adsl to CallableFunction environment</span></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>fun<span class="sc">$</span><span class="fu">assign_to_env</span>(<span class="st">&quot;adsl&quot;</span>, adsl_raw)</span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a><span class="co"># set arguments</span></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>fun<span class="sc">$</span><span class="fu">set_args</span>(<span class="at">args =</span> <span class="fu">list</span>(<span class="at">adsl =</span> <span class="fu">as.name</span>(<span class="st">&quot;adsl&quot;</span>)))</span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a><span class="co"># execute function</span></span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> fun<span class="sc">$</span><span class="fu">run</span>()</span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(df, <span class="dv">3</span>)</span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 3 × 45</span></span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   STUDYID USUBJID     SUBJID SITEID   AGE AGEU  SEX   RACE  ETHNIC COUNTRY DTHFL</span></span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   &lt;chr&gt;   &lt;chr&gt;       &lt;chr&gt;  &lt;chr&gt;  &lt;int&gt; &lt;fct&gt; &lt;fct&gt; &lt;fct&gt; &lt;fct&gt;  &lt;fct&gt;   &lt;fct&gt;</span></span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1 AB12345 AB12345-CH… id-128 CHN-3     32 YEARS M     ASIAN NOT H… CHN     N    </span></span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2 AB12345 AB12345-CH… id-262 CHN-15    35 YEARS M     BLAC… NOT H… CHN     N    </span></span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3 AB12345 AB12345-RU… id-378 RUS-3     30 YEARS F     ASIAN NOT H… RUS     N    </span></span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # … with 34 more variables: INVID &lt;chr&gt;, INVNAM &lt;chr&gt;, ARM &lt;fct&gt;, ARMCD &lt;fct&gt;,</span></span>
<span id="cb3-25"><a href="#cb3-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; #   ACTARM &lt;fct&gt;, ACTARMCD &lt;fct&gt;, TRT01P &lt;fct&gt;, TRT01A &lt;fct&gt;, REGION1 &lt;fct&gt;,</span></span>
<span id="cb3-26"><a href="#cb3-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; #   STRATA1 &lt;fct&gt;, STRATA2 &lt;fct&gt;, BMRKR1 &lt;dbl&gt;, BMRKR2 &lt;fct&gt;, ITTFL &lt;fct&gt;,</span></span>
<span id="cb3-27"><a href="#cb3-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; #   SAFFL &lt;fct&gt;, BMEASIFL &lt;fct&gt;, BEP01FL &lt;fct&gt;, RANDDT &lt;date&gt;, TRTSDTM &lt;dttm&gt;,</span></span>
<span id="cb3-28"><a href="#cb3-28" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; #   TRTEDTM &lt;dttm&gt;, EOSSTT &lt;fct&gt;, EOTSTT &lt;fct&gt;, EOSDT &lt;date&gt;, EOSDY &lt;int&gt;,</span></span>
<span id="cb3-29"><a href="#cb3-29" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; #   DCSREAS &lt;fct&gt;, DTHDT &lt;date&gt;, DTHCAUS &lt;fct&gt;, DTHCAT &lt;fct&gt;, LDDTHELD &lt;int&gt;,</span></span>
<span id="cb3-30"><a href="#cb3-30" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; #   LDDTHGR1 &lt;fct&gt;, LSTALVDT &lt;date&gt;, DTHADY &lt;int&gt;, study_duration_secs &lt;dbl&gt;, …</span></span>
<span id="cb3-31"><a href="#cb3-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-32"><a href="#cb3-32" aria-hidden="true" tabindex="-1"></a><span class="co"># get R code</span></span>
<span id="cb3-33"><a href="#cb3-33" aria-hidden="true" tabindex="-1"></a>fun<span class="sc">$</span><span class="fu">get_call</span>()</span>
<span id="cb3-34"><a href="#cb3-34" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;(function(adsl) {\n    adsl_2 &lt;- adsl\n    adsl_2$new_col &lt;- TRUE\n    adsl_2\n})(adsl = adsl)&quot;</span></span></code></pre></div>
</div>
</div>
<div id="callablecode" class="section level3">
<h3><code>CallableCode</code></h3>
<p>A simpler version of the <code>Callable</code> class is
<code>CallableCode</code>. Similar to <code>CallableFunction</code>,
<code>CallableCode</code> stores code which can be evaluated using
<code>run()</code> but it isn’t able to use dynamic arguments to make
the code more general. <code>CallableCode</code> also allows the
assignment of objects to its environment. <code>CallableCode</code> can
contain multiple lines (commands) of code and also allows
<code>library</code> calls. Please note that objects assigned to this
independent environment can’t be modified because they are locked
immediately. This means that the <code>CallableCode</code> created below
is not allowed to make any changes to <code>x1</code>.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>code <span class="ot">&lt;-</span> <span class="fu">callable_code</span>(</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;library(scda)</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="st">  ADTTE &lt;- synthetic_cdisc_dataset(dataset_name = </span><span class="sc">\&quot;</span><span class="st">adtte</span><span class="sc">\&quot;</span><span class="st">, name = </span><span class="sc">\&quot;</span><span class="st">latest</span><span class="sc">\&quot;</span><span class="st">)</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="st">  ADTTE$x1 &lt;- x1</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a><span class="st">  ADTTE &lt;- dplyr::filter(ADTTE, PARAMCD %in% c(&#39;EFS&#39;, &#39;OS&#39;))&quot;</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a><span class="co"># examine call</span></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(code<span class="sc">$</span><span class="fu">get_call</span>())</span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; library(scda)</span></span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ADTTE &lt;- synthetic_cdisc_dataset(dataset_name = &quot;adtte&quot;, name = &quot;latest&quot;)</span></span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ADTTE$x1 &lt;- x1</span></span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ADTTE &lt;- dplyr::filter(ADTTE, PARAMCD %in% c(&quot;EFS&quot;, &quot;OS&quot;))</span></span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a><span class="co"># assign x1 to environment (otherwise code would run with error as x1 would not be defined)</span></span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a>code<span class="sc">$</span><span class="fu">assign_to_env</span>(<span class="st">&quot;x1&quot;</span>, <span class="dv">1</span>)</span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a><span class="co"># evaluate call</span></span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> code<span class="sc">$</span><span class="fu">run</span>()</span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(df<span class="sc">$</span>x1, <span class="dv">3</span>)</span>
<span id="cb4-21"><a href="#cb4-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 1 1 1</span></span></code></pre></div>
</div>
<div id="tealdataset-base-class-which-cdisctealdataset-inherits-from" class="section level3">
<h3><code>TealDataset</code> (base class which
<code>CDISCTealDataset</code> inherits from)</h3>
<p><code>TealDataset</code> is an R6 class which keeps a
<code>data.frame</code> in its <code>raw_data</code> slot. One can
create a <code>TealDataset</code> by including <code>data.frame</code>
and setting data attributes. In the example below we first create
<code>adsl</code> and then put this <code>data.frame</code> into the
<code>cdisc_dataset</code> function. Together with
<code>data.frame</code> one should also provide a <code>dataname</code>
and optional <code>code</code> to reproduce the data if reproducibility
is required.</p>
<p>Note <code>cdisc_dataset</code> returns an object of
<code>CDISCTealDataset</code>, which is needed for CDISC analysis.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(magrittr)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>adsl_raw <span class="ot">&lt;-</span> <span class="fu">synthetic_cdisc_dataset</span>(<span class="at">dataset_name =</span> <span class="st">&quot;adsl&quot;</span>, <span class="at">name =</span> <span class="st">&quot;latest&quot;</span>) <span class="sc">%&gt;%</span> <span class="fu">head</span>(<span class="dv">3</span>)</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>adsl_dataset <span class="ot">&lt;-</span> <span class="fu">cdisc_dataset</span>(</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">dataname =</span> <span class="st">&quot;ADSL&quot;</span>,</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> adsl_raw,</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">code =</span> <span class="st">&quot;ADSL &lt;- synthetic_cdisc_dataset(dataset_name = </span><span class="sc">\&quot;</span><span class="st">adsl</span><span class="sc">\&quot;</span><span class="st">, name = </span><span class="sc">\&quot;</span><span class="st">latest</span><span class="sc">\&quot;</span><span class="st">) %&gt;% head(3)&quot;</span></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<p>The object created above contains all previously defined attributes
which can be extracted.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># check if code is reproducible</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="fu">get_dataname</span>(adsl_dataset)</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;ADSL&quot;</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a><span class="co"># get label</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a><span class="fu">get_dataset_label</span>(adsl_dataset)</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;Subject Level Analysis Dataset&quot;</span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a><span class="co"># get reproducible code</span></span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a><span class="fu">get_code</span>(adsl_dataset)</span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;ADSL &lt;- synthetic_cdisc_dataset(dataset_name = \&quot;adsl\&quot;, name = \&quot;latest\&quot;) %&gt;% head(3)&quot;</span></span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a><span class="co"># get data.frame</span></span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a><span class="fu">get_raw_data</span>(adsl_dataset)</span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 3 × 44</span></span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   STUDYID USUBJID     SUBJID SITEID   AGE AGEU  SEX   RACE  ETHNIC COUNTRY DTHFL</span></span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   &lt;chr&gt;   &lt;chr&gt;       &lt;chr&gt;  &lt;chr&gt;  &lt;int&gt; &lt;fct&gt; &lt;fct&gt; &lt;fct&gt; &lt;fct&gt;  &lt;fct&gt;   &lt;fct&gt;</span></span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1 AB12345 AB12345-CH… id-128 CHN-3     32 YEARS M     ASIAN NOT H… CHN     N    </span></span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2 AB12345 AB12345-CH… id-262 CHN-15    35 YEARS M     BLAC… NOT H… CHN     N    </span></span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3 AB12345 AB12345-RU… id-378 RUS-3     30 YEARS F     ASIAN NOT H… RUS     N    </span></span>
<span id="cb6-21"><a href="#cb6-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # … with 33 more variables: INVID &lt;chr&gt;, INVNAM &lt;chr&gt;, ARM &lt;fct&gt;, ARMCD &lt;fct&gt;,</span></span>
<span id="cb6-22"><a href="#cb6-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; #   ACTARM &lt;fct&gt;, ACTARMCD &lt;fct&gt;, TRT01P &lt;fct&gt;, TRT01A &lt;fct&gt;, REGION1 &lt;fct&gt;,</span></span>
<span id="cb6-23"><a href="#cb6-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; #   STRATA1 &lt;fct&gt;, STRATA2 &lt;fct&gt;, BMRKR1 &lt;dbl&gt;, BMRKR2 &lt;fct&gt;, ITTFL &lt;fct&gt;,</span></span>
<span id="cb6-24"><a href="#cb6-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; #   SAFFL &lt;fct&gt;, BMEASIFL &lt;fct&gt;, BEP01FL &lt;fct&gt;, RANDDT &lt;date&gt;, TRTSDTM &lt;dttm&gt;,</span></span>
<span id="cb6-25"><a href="#cb6-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; #   TRTEDTM &lt;dttm&gt;, EOSSTT &lt;fct&gt;, EOTSTT &lt;fct&gt;, EOSDT &lt;date&gt;, EOSDY &lt;int&gt;,</span></span>
<span id="cb6-26"><a href="#cb6-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; #   DCSREAS &lt;fct&gt;, DTHDT &lt;date&gt;, DTHCAUS &lt;fct&gt;, DTHCAT &lt;fct&gt;, LDDTHELD &lt;int&gt;,</span></span>
<span id="cb6-27"><a href="#cb6-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; #   LDDTHGR1 &lt;fct&gt;, LSTALVDT &lt;date&gt;, DTHADY &lt;int&gt;, study_duration_secs &lt;dbl&gt;</span></span>
<span id="cb6-28"><a href="#cb6-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-29"><a href="#cb6-29" aria-hidden="true" tabindex="-1"></a><span class="co"># get keys (i.e. the primary keys of the dataset)</span></span>
<span id="cb6-30"><a href="#cb6-30" aria-hidden="true" tabindex="-1"></a>adsl_dataset<span class="sc">$</span><span class="fu">get_keys</span>()</span>
<span id="cb6-31"><a href="#cb6-31" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;STUDYID&quot; &quot;USUBJID&quot;</span></span></code></pre></div>
</div>
<div id="tealdatasetconnector-base-class-which-cdisctealdatasetconnector-inherits-from" class="section level3">
<h3><code>TealDatasetConnector</code> (base class which
<code>CDISCTealDatasetConnector</code> inherits from)</h3>
<p><code>TealDatasetConnector</code> contains a <code>Callable</code>
object to obtain a single <code>TealDataset</code> object. In the code
chunk below, a connector is created based on the
<code>synthetic_cdisc_dataset</code> function.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>adsl_conn <span class="ot">&lt;-</span> <span class="fu">dataset_connector</span>(</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">dataname =</span> <span class="st">&quot;ADSL&quot;</span>,</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">pull_callable =</span> <span class="fu">callable_function</span>(<span class="st">&quot;synthetic_cdisc_dataset&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">set_args</span>(<span class="fu">list</span>(<span class="at">dataset_name =</span> <span class="st">&quot;adsl&quot;</span>, <span class="at">name =</span> <span class="st">&quot;latest&quot;</span>)),</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">keys =</span> <span class="fu">get_cdisc_keys</span>(<span class="st">&quot;ADSL&quot;</span>),</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">label =</span> <span class="st">&quot;Subject-Level Analysis Dataset&quot;</span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<p>Initially, <code>adsl_conn</code> doesn’t contain any data.
Attempting to fetch unavailable data will produce an error.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># get raw data</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="fu">try</span>(<span class="fu">get_raw_data</span>(adsl_conn))</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Error : &#39;ADSL&#39; has not been pulled yet</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  - please use `load_dataset()` first.</span></span></code></pre></div>
<p>Data can be loaded using <code>load_dataset()</code> function. Before
data is loaded, <code>adsl_conn</code> contains reproducible code which
is also the code to pull the data.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># execution/reproducible code</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="fu">get_code</span>(adsl_conn)</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;ADSL &lt;- scda::synthetic_cdisc_dataset(dataset_name = \&quot;adsl\&quot;, name = \&quot;latest\&quot;)&quot;</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a><span class="co"># pull data</span></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a><span class="fu">load_dataset</span>(adsl_conn)</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a><span class="co"># get raw data</span></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a><span class="fu">get_raw_data</span>(adsl_conn)</span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 400 × 44</span></span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    STUDYID USUBJID    SUBJID SITEID   AGE AGEU  SEX   RACE  ETHNIC COUNTRY DTHFL</span></span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    &lt;chr&gt;   &lt;chr&gt;      &lt;chr&gt;  &lt;chr&gt;  &lt;int&gt; &lt;fct&gt; &lt;fct&gt; &lt;fct&gt; &lt;fct&gt;  &lt;fct&gt;   &lt;fct&gt;</span></span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  1 AB12345 AB12345-C… id-128 CHN-3     32 YEARS M     ASIAN NOT H… CHN     N    </span></span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  2 AB12345 AB12345-C… id-262 CHN-15    35 YEARS M     BLAC… NOT H… CHN     N    </span></span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  3 AB12345 AB12345-R… id-378 RUS-3     30 YEARS F     ASIAN NOT H… RUS     N    </span></span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  4 AB12345 AB12345-C… id-220 CHN-11    26 YEARS F     ASIAN NOT H… CHN     N    </span></span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  5 AB12345 AB12345-C… id-267 CHN-7     40 YEARS M     ASIAN UNKNO… CHN     N    </span></span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  6 AB12345 AB12345-C… id-201 CHN-15    49 YEARS M     ASIAN NOT H… CHN     N    </span></span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  7 AB12345 AB12345-U… id-45  USA-1     34 YEARS F     ASIAN NOT H… USA     N    </span></span>
<span id="cb9-20"><a href="#cb9-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  8 AB12345 AB12345-U… id-261 USA-1     32 YEARS F     ASIAN NOT H… USA     N    </span></span>
<span id="cb9-21"><a href="#cb9-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  9 AB12345 AB12345-N… id-173 NGA-11    24 YEARS F     BLAC… NOT H… NGA     N    </span></span>
<span id="cb9-22"><a href="#cb9-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 10 AB12345 AB12345-C… id-307 CHN-1     24 YEARS M     ASIAN NOT H… CHN     N    </span></span>
<span id="cb9-23"><a href="#cb9-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # … with 390 more rows, and 33 more variables: INVID &lt;chr&gt;, INVNAM &lt;chr&gt;,</span></span>
<span id="cb9-24"><a href="#cb9-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; #   ARM &lt;fct&gt;, ARMCD &lt;fct&gt;, ACTARM &lt;fct&gt;, ACTARMCD &lt;fct&gt;, TRT01P &lt;fct&gt;,</span></span>
<span id="cb9-25"><a href="#cb9-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; #   TRT01A &lt;fct&gt;, REGION1 &lt;fct&gt;, STRATA1 &lt;fct&gt;, STRATA2 &lt;fct&gt;, BMRKR1 &lt;dbl&gt;,</span></span>
<span id="cb9-26"><a href="#cb9-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; #   BMRKR2 &lt;fct&gt;, ITTFL &lt;fct&gt;, SAFFL &lt;fct&gt;, BMEASIFL &lt;fct&gt;, BEP01FL &lt;fct&gt;,</span></span>
<span id="cb9-27"><a href="#cb9-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; #   RANDDT &lt;date&gt;, TRTSDTM &lt;dttm&gt;, TRTEDTM &lt;dttm&gt;, EOSSTT &lt;fct&gt;, EOTSTT &lt;fct&gt;,</span></span>
<span id="cb9-28"><a href="#cb9-28" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; #   EOSDT &lt;date&gt;, EOSDY &lt;int&gt;, DCSREAS &lt;fct&gt;, DTHDT &lt;date&gt;, DTHCAUS &lt;fct&gt;,</span></span>
<span id="cb9-29"><a href="#cb9-29" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; #   DTHCAT &lt;fct&gt;, LDDTHELD &lt;int&gt;, LDDTHGR1 &lt;fct&gt;, LSTALVDT &lt;date&gt;, …</span></span></code></pre></div>
<p><code>TealDatasetConnector</code> also allows other variables to be
passed to its <code>Callable</code> object that may depend on them. In
the code below the <code>adsl_raw</code> object - created above - is
added to the <code>CallableFunction</code>. To properly link the
<code>ADSL</code> argument of the function inside the
<code>CallableFunction</code> object with the raw data
<code>adsl_raw</code> several parameters have to match:</p>
<ol style="list-style-type: decimal">
<li><code>as.name(&quot;dummy_name&quot;)</code> must be the value with name
<code>&quot;ADSL&quot;</code> -
<code>set_args(list(ADSL = as.name(&quot;dummy_name&quot;)))</code></li>
<li>and then <code>dummy_name</code> must be linked with the raw data
<code>adsl_raw</code> -
<code>vars = list(dummy_name = adsl_raw)</code></li>
</ol>
<p>The name <code>ADSL</code> is fixed because it is the name of the
argument of the function inside of the <code>CallableFunction</code>.
The name <code>dummy_name</code> is free to be any valid <code>R</code>
name.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># here we use the general dataset_connector function which pulls an object of type TealDataset</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="co"># there is also a cdisc_dataset_connector function which pulls an object of type CDISCTealDataset</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>adsl_2 <span class="ot">&lt;-</span> <span class="fu">dataset_connector</span>(</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">dataname =</span> <span class="st">&quot;ADSL_2&quot;</span>,</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">pull_callable =</span> <span class="fu">callable_function</span>(<span class="at">fun =</span> <span class="cf">function</span>(ADSL) ADSL_2 <span class="ot">&lt;-</span> ADSL) <span class="sc">%&gt;%</span> <span class="co"># nolint</span></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">set_args</span>(<span class="fu">list</span>(<span class="at">ADSL =</span> <span class="fu">as.name</span>(<span class="st">&quot;dummy_name&quot;</span>))),</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">keys =</span> <span class="fu">get_cdisc_keys</span>(<span class="st">&quot;ADSL&quot;</span>),</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">label =</span> <span class="st">&quot;Example label&quot;</span>,</span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">vars =</span> <span class="fu">list</span>(<span class="at">dummy_name =</span> adsl_raw)</span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a><span class="fu">load_dataset</span>(adsl_2)</span></code></pre></div>
<p><code>TealDatasetConnector</code> like the other delayed data objects
contains a <code>launch</code> method which can be used to obtain data
using shiny application. This function can be used to check if the
objects are specified correctly and to investigate potential mistakes.
By default the shiny app won’t render any inputs for datasets until we
specify them. To set inputs we should use <code>$set_ui_input()</code>,
by passing ui module function, with <code>ns</code> argument
(<code>shiny</code> namespace ID object). In the example below, the
<code>callable_function</code> object contains two arguments,
<code>ADSL</code> and <code>n</code>. <code>ADSL</code> is given while
<code>n</code> is entered from a shiny app after the <code>launch</code>
method is called.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>adsl_3 <span class="ot">&lt;-</span> <span class="fu">dataset_connector</span>(</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">dataname =</span> <span class="st">&quot;ADSL_3&quot;</span>,</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">pull_callable =</span> <span class="fu">callable_function</span>(<span class="at">fun =</span> <span class="cf">function</span>(ADSL, n) ADSL_3 <span class="ot">&lt;-</span> <span class="fu">head</span>(ADSL, n)) <span class="sc">%&gt;%</span> <span class="co"># nolint</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">set_args</span>(<span class="fu">list</span>(<span class="at">ADSL =</span> <span class="fu">as.name</span>(<span class="st">&quot;ADSL&quot;</span>))),</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">keys =</span> <span class="fu">get_cdisc_keys</span>(<span class="st">&quot;ADSL&quot;</span>),</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">label =</span> <span class="st">&quot;Example label&quot;</span>,</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">vars =</span> <span class="fu">list</span>(<span class="at">ADSL =</span> adsl_raw)</span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>adsl_3<span class="sc">$</span><span class="fu">set_ui_input</span>(<span class="cf">function</span>(ns) {</span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list</span>(</span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">numericInput</span>(<span class="at">inputId =</span> <span class="fu">ns</span>(<span class="st">&quot;n&quot;</span>), <span class="at">label =</span> <span class="st">&quot;Choose number of records&quot;</span>, <span class="at">min =</span> <span class="dv">0</span>, <span class="at">value =</span> <span class="dv">1</span>)</span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">interactive</span>()) {</span>
<span id="cb11-17"><a href="#cb11-17" aria-hidden="true" tabindex="-1"></a>  adsl_3<span class="sc">$</span><span class="fu">launch</span>()</span>
<span id="cb11-18"><a href="#cb11-18" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
</div>
<div id="tealdataconnection" class="section level3">
<h3><code>TealDataConnection</code></h3>
<p>Objects of this class are responsible to set a connection with remote
data sources. <code>TealDataConnection</code> opens and closes
connections by calling <code>CallableFunction</code> with the
appropriate arguments.</p>
<p>Note that if an app pulls data from a remote source, then the outputs
will change even if the code is the same if the data in the remote
source changes.</p>
<p>In <code>shiny</code> applications, connection arguments need to be
linked with <code>inputs</code>, which is why
<code>TealDataConnection</code> contains a module. Developers can
customize UI inputs to open the connection using
<code>set_open_ui()</code> and specify a relevant server function using
<code>set_open_server()</code>. It’s important to keep in mind that the
server module needs a connection as an argument to <code>open()</code>
and <code>close()</code> if needed.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>open_fun <span class="ot">&lt;-</span> <span class="fu">callable_function</span>(data.frame) <span class="co"># define opening function</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>open_fun<span class="sc">$</span><span class="fu">set_args</span>(<span class="fu">list</span>(<span class="at">x =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>)) <span class="co"># define fixed arguments to opening function</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>close_fun <span class="ot">&lt;-</span> <span class="fu">callable_function</span>(sum) <span class="co"># define closing function</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>close_fun<span class="sc">$</span><span class="fu">set_args</span>(<span class="fu">list</span>(<span class="at">x =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>)) <span class="co"># define fixed arguments to closing function</span></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>ping_fun <span class="ot">&lt;-</span> <span class="fu">callable_function</span>(<span class="cf">function</span>() <span class="cn">TRUE</span>)</span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">data_connection</span>(</span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">ping_fun =</span> ping_fun, <span class="co"># define ping function</span></span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">open_fun =</span> open_fun, <span class="co"># define opening function</span></span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">close_fun =</span> close_fun <span class="co"># define closing function</span></span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
</div>
<div id="tealdataconnector-base-class-which-cdisctealdataconnector-inherits-from" class="section level3">
<h3><code>TealDataConnector</code> (base class which
<code>CDISCTealDataConnector</code> inherits from)</h3>
<p>This class combines multiple <code>TealDatasetConnector</code> (or
<code>CDISCTealDatasetConnector</code>) and a single
<code>TealDataConnection</code> object. It creates a module to manage
connection and to load data. Below we create two
<code>TealDatasetConnector</code> objects and a
<code>TealDataConnection</code> object and we combine them together in a
<code>TealDataConnector</code> object.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># create TealDatasetConnectors</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>adsl <span class="ot">&lt;-</span> <span class="fu">dataset_connector</span>(</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">dataname =</span> <span class="st">&quot;ADSL&quot;</span>,</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">pull_callable =</span> <span class="fu">callable_function</span>(<span class="st">&quot;synthetic_cdisc_dataset&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">set_args</span>(<span class="fu">list</span>(<span class="at">dataset_name =</span> <span class="st">&quot;adsl&quot;</span>, <span class="at">name =</span> <span class="st">&quot;latest&quot;</span>)),</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">keys =</span> <span class="fu">get_cdisc_keys</span>(<span class="st">&quot;ADSL&quot;</span>),</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">label =</span> <span class="st">&quot;Subject-Level Analysis Dataset&quot;</span></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>adsl_3 <span class="ot">&lt;-</span> <span class="fu">dataset_connector</span>(</span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">dataname =</span> <span class="st">&quot;ADSL_3&quot;</span>,</span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">pull_callable =</span> <span class="fu">callable_function</span>(<span class="at">fun =</span> <span class="cf">function</span>(ADSL, name, <span class="at">n =</span> <span class="dv">5</span>) { <span class="co"># nolint</span></span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">&quot;slicing data from&quot;</span>, name))</span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a>    ADSL_3 <span class="ot">&lt;-</span> <span class="fu">head</span>(ADSL, n) <span class="co"># nolint</span></span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a>  }) <span class="sc">%&gt;%</span></span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">set_args</span>(<span class="fu">list</span>(<span class="at">ADSL =</span> <span class="fu">as.name</span>(<span class="st">&quot;ADSL&quot;</span>))),</span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">keys =</span> <span class="fu">get_cdisc_keys</span>(<span class="st">&quot;ADSL&quot;</span>),</span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true" tabindex="-1"></a>  <span class="at">label =</span> <span class="st">&quot;Example label&quot;</span>,</span>
<span id="cb13-19"><a href="#cb13-19" aria-hidden="true" tabindex="-1"></a>  <span class="at">vars =</span> <span class="fu">list</span>(<span class="at">ADSL =</span> adsl)</span>
<span id="cb13-20"><a href="#cb13-20" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb13-21"><a href="#cb13-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-22"><a href="#cb13-22" aria-hidden="true" tabindex="-1"></a>adsl_3<span class="sc">$</span><span class="fu">set_ui_input</span>(<span class="cf">function</span>(ns) {</span>
<span id="cb13-23"><a href="#cb13-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list</span>(</span>
<span id="cb13-24"><a href="#cb13-24" aria-hidden="true" tabindex="-1"></a>    <span class="fu">numericInput</span>(<span class="at">inputId =</span> <span class="fu">ns</span>(<span class="st">&quot;n&quot;</span>), <span class="at">label =</span> <span class="st">&quot;Choose number of records&quot;</span>, <span class="at">min =</span> <span class="dv">0</span>, <span class="at">value =</span> <span class="dv">1</span>)</span>
<span id="cb13-25"><a href="#cb13-25" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb13-26"><a href="#cb13-26" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb13-27"><a href="#cb13-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-28"><a href="#cb13-28" aria-hidden="true" tabindex="-1"></a>connectors <span class="ot">&lt;-</span> <span class="fu">list</span>(adsl, adsl_3)</span>
<span id="cb13-29"><a href="#cb13-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-30"><a href="#cb13-30" aria-hidden="true" tabindex="-1"></a><span class="co"># create connection</span></span>
<span id="cb13-31"><a href="#cb13-31" aria-hidden="true" tabindex="-1"></a>scda_open_fun <span class="ot">&lt;-</span> <span class="fu">callable_function</span>(<span class="at">fun =</span> library)</span>
<span id="cb13-32"><a href="#cb13-32" aria-hidden="true" tabindex="-1"></a>scda_open_fun<span class="sc">$</span><span class="fu">set_args</span>(<span class="fu">list</span>(<span class="at">package =</span> <span class="st">&quot;scda&quot;</span>))</span>
<span id="cb13-33"><a href="#cb13-33" aria-hidden="true" tabindex="-1"></a>scda_conn <span class="ot">&lt;-</span> teal.data<span class="sc">:::</span>TealDataConnection<span class="sc">$</span><span class="fu">new</span>(<span class="at">open_fun =</span> scda_open_fun) <span class="co"># nolint</span></span>
<span id="cb13-34"><a href="#cb13-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-35"><a href="#cb13-35" aria-hidden="true" tabindex="-1"></a><span class="co"># create TealDataConnector</span></span>
<span id="cb13-36"><a href="#cb13-36" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> teal.data<span class="sc">:::</span>TealDataConnector<span class="sc">$</span><span class="fu">new</span>(</span>
<span id="cb13-37"><a href="#cb13-37" aria-hidden="true" tabindex="-1"></a>  <span class="at">connection =</span> scda_conn,</span>
<span id="cb13-38"><a href="#cb13-38" aria-hidden="true" tabindex="-1"></a>  <span class="at">connectors =</span> connectors</span>
<span id="cb13-39"><a href="#cb13-39" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<p>The object created above can be used to pull data and obtain the
code. It combines code to pull the datasets preceded by any open
connection code and followed by any close connection code. Please note
that <code>TealDataConnector</code> doesn’t limit what kind of
connectors are set within, but one must be aware that it should rather
contain similar connectors (i.e. calling functions which share some
arguments). For example, if we execute
<code>data$set_pull_args(args = list(name = &quot;latest&quot;))</code>, this
argument will be set for all connectors. In case when any connector
contains a <code>CallableFunction</code> which doesn’t have
<code>name</code> in its formals then it will fail.
<code>CallableCode</code> can’t hold any additional arguments as it’s
fixed and it will ignore every arguments set with
<code>set_pull_args</code>.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">get_code</span>(data))</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; library(package = &quot;scda&quot;)</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ADSL &lt;- scda::synthetic_cdisc_dataset(dataset_name = &quot;adsl&quot;, name = &quot;latest&quot;)</span></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ADSL_3 &lt;- (function(ADSL, name, n = 5) {</span></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     print(paste(&quot;slicing data from&quot;, name))</span></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     ADSL_3 &lt;- head(ADSL, n)</span></span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; })(ADSL = ADSL)</span></span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a><span class="co"># pull ADSL and ADSL_3</span></span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span><span class="fu">set_pull_args</span>(<span class="at">args =</span> <span class="fu">list</span>(<span class="at">name =</span> <span class="st">&quot;latest&quot;</span>))</span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span><span class="fu">pull</span>()</span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;slicing data from latest&quot;</span></span></code></pre></div>
<p>By default <code>TealDataConnector</code> creates simple shiny module
without any inputs to the arguments for the
<code>callable_function</code> of the connectors. This means that,
opening, closing, and pulling datasets are done on default arguments.
However, users can easily extend the module using <code>set_ui()</code>
and <code>set_server()</code> to specify the UI and server function
themselves. The general rule for creating these modules is that callback
from server to UI is not possible, because server module is executed
after the submit button is clicked. But see
<code>set_preopen_server</code> of <code>TealDataConnection</code>
object for a slight relaxation of this rule. Below we extend the app
interface by adding a text input which will be passed to the
<code>scda</code> function. The UI is created from
<code>scda_conn</code> and <code>connectors</code> object while the
server module requires <code>connectors</code> and
<code>connection</code> objects as additional arguments.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span><span class="fu">set_ui</span>(</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>  <span class="cf">function</span>(id, ...) {</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>    ns <span class="ot">&lt;-</span> <span class="fu">NS</span>(id)</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tagList</span>(</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>      scda_conn<span class="sc">$</span><span class="fu">get_open_ui</span>(<span class="fu">ns</span>(<span class="st">&quot;open_connection&quot;</span>)),</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>      <span class="fu">textInput</span>(<span class="fu">ns</span>(<span class="st">&quot;name&quot;</span>), <span class="fu">p</span>(<span class="st">&quot;Choose&quot;</span>, <span class="fu">code</span>(<span class="st">&quot;name&quot;</span>)), <span class="at">value =</span> <span class="st">&quot;latest&quot;</span>),</span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>      <span class="fu">do.call</span>(</span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>        <span class="at">what =</span> <span class="st">&quot;tagList&quot;</span>,</span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>        <span class="at">args =</span> <span class="fu">lapply</span>(</span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>          connectors,</span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>          <span class="cf">function</span>(connector) {</span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>            <span class="fu">div</span>(</span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a>              connector<span class="sc">$</span><span class="fu">get_ui</span>(</span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a>                <span class="at">id =</span> <span class="fu">ns</span>(connector<span class="sc">$</span><span class="fu">get_dataname</span>())</span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a>              ),</span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a>              <span class="fu">br</span>()</span>
<span id="cb15-17"><a href="#cb15-17" aria-hidden="true" tabindex="-1"></a>            )</span>
<span id="cb15-18"><a href="#cb15-18" aria-hidden="true" tabindex="-1"></a>          }</span>
<span id="cb15-19"><a href="#cb15-19" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb15-20"><a href="#cb15-20" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb15-21"><a href="#cb15-21" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb15-22"><a href="#cb15-22" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb15-23"><a href="#cb15-23" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb15-24"><a href="#cb15-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-25"><a href="#cb15-25" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span><span class="fu">set_server</span>(</span>
<span id="cb15-26"><a href="#cb15-26" aria-hidden="true" tabindex="-1"></a>  <span class="cf">function</span>(id, connection, connectors) {</span>
<span id="cb15-27"><a href="#cb15-27" aria-hidden="true" tabindex="-1"></a>    <span class="fu">moduleServer</span>(</span>
<span id="cb15-28"><a href="#cb15-28" aria-hidden="true" tabindex="-1"></a>      <span class="at">id =</span> id,</span>
<span id="cb15-29"><a href="#cb15-29" aria-hidden="true" tabindex="-1"></a>      <span class="at">module =</span> <span class="cf">function</span>(input, output, session) {</span>
<span id="cb15-30"><a href="#cb15-30" aria-hidden="true" tabindex="-1"></a>        <span class="co"># opens connection</span></span>
<span id="cb15-31"><a href="#cb15-31" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.null</span>(connection<span class="sc">$</span><span class="fu">get_open_server</span>())) {</span>
<span id="cb15-32"><a href="#cb15-32" aria-hidden="true" tabindex="-1"></a>          connection<span class="sc">$</span><span class="fu">get_open_server</span>()(</span>
<span id="cb15-33"><a href="#cb15-33" aria-hidden="true" tabindex="-1"></a>            <span class="at">id =</span> <span class="st">&quot;open_connection&quot;</span>,</span>
<span id="cb15-34"><a href="#cb15-34" aria-hidden="true" tabindex="-1"></a>            <span class="at">connection =</span> connection</span>
<span id="cb15-35"><a href="#cb15-35" aria-hidden="true" tabindex="-1"></a>          )</span>
<span id="cb15-36"><a href="#cb15-36" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb15-37"><a href="#cb15-37" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> (connector <span class="cf">in</span> connectors) {</span>
<span id="cb15-38"><a href="#cb15-38" aria-hidden="true" tabindex="-1"></a>          <span class="co"># set_args before to return them in the code (fixed args)</span></span>
<span id="cb15-39"><a href="#cb15-39" aria-hidden="true" tabindex="-1"></a>          <span class="fu">set_args</span>(connector, <span class="at">args =</span> <span class="fu">list</span>(<span class="at">name =</span> input<span class="sc">$</span>name))</span>
<span id="cb15-40"><a href="#cb15-40" aria-hidden="true" tabindex="-1"></a>          <span class="co"># pull each dataset</span></span>
<span id="cb15-41"><a href="#cb15-41" aria-hidden="true" tabindex="-1"></a>          connector<span class="sc">$</span><span class="fu">get_server</span>()(<span class="at">id =</span> connector<span class="sc">$</span><span class="fu">get_dataname</span>())</span>
<span id="cb15-42"><a href="#cb15-42" aria-hidden="true" tabindex="-1"></a>          <span class="cf">if</span> (connector<span class="sc">$</span><span class="fu">is_failed</span>()) {</span>
<span id="cb15-43"><a href="#cb15-43" aria-hidden="true" tabindex="-1"></a>            <span class="cf">break</span></span>
<span id="cb15-44"><a href="#cb15-44" aria-hidden="true" tabindex="-1"></a>          }</span>
<span id="cb15-45"><a href="#cb15-45" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb15-46"><a href="#cb15-46" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb15-47"><a href="#cb15-47" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb15-48"><a href="#cb15-48" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb15-49"><a href="#cb15-49" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<p>Executing <code>data$launch()</code> will open a shiny application
that prompts the user for input to load the data. Remember that data can
be loaded only once. So if you run the code to <code>data$pull()</code>
above please reinitialize the connectors, connection and data object
again before running the code below.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">interactive</span>()) {</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>  data<span class="sc">$</span><span class="fu">launch</span>()</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
</div>
<div id="tealdata-base-class-which-cdisctealdata-inherits-from" class="section level3">
<h3><code>TealData</code> (base class which <code>CDISCTealData</code>
inherits from)</h3>
<p><code>TealData</code> manages <code>TealDataset</code>,
<code>TealDatasetConnector</code> and / or
<code>TealDataConnector</code> objects. <code>CDISCTealData</code> is
the equivalent object when creating apps to analyze CDISC data. These
objects are created using <code>teal_data</code> and
<code>cdisc_data</code> respectively. When using the <code>teal</code>
package these objects are passed as the <code>data</code> argument into
<code>init</code>.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">cdisc_data</span>(</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cdisc_dataset</span>(</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">dataname =</span> <span class="st">&quot;ADSL&quot;</span>,</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">synthetic_cdisc_dataset</span>(<span class="at">dataset_name =</span> <span class="st">&quot;adsl&quot;</span>, <span class="at">name =</span> <span class="st">&quot;latest&quot;</span>),</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">code =</span> <span class="st">&quot;ADSL &lt;- synthetic_cdisc_dataset(dataset_name = </span><span class="sc">\&quot;</span><span class="st">adsl</span><span class="sc">\&quot;</span><span class="st">, name = </span><span class="sc">\&quot;</span><span class="st">latest</span><span class="sc">\&quot;</span><span class="st">)&quot;</span></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cdisc_dataset</span>(</span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">dataname =</span> <span class="st">&quot;ADTTE&quot;</span>,</span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">synthetic_cdisc_dataset</span>(<span class="at">dataset_name =</span> <span class="st">&quot;adtte&quot;</span>, <span class="at">name =</span> <span class="st">&quot;latest&quot;</span>),</span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">code =</span> <span class="st">&quot;ADTTE &lt;- synthetic_cdisc_dataset(dataset_name = </span><span class="sc">\&quot;</span><span class="st">adtte</span><span class="sc">\&quot;</span><span class="st">, name = </span><span class="sc">\&quot;</span><span class="st">latest</span><span class="sc">\&quot;</span><span class="st">)&quot;</span></span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<p>One can combine multiple delayed data objects using
<code>[teal|cdisc]_data</code> functions and include them in a shiny
application. <code>TealData</code> gathers all objects and sets combined
UI with shiny inputs from all objects. In the code chunk below we
specified four dataset connectors, but it works with arbitrary many
objects of any combination of the classes <code>TealDataset</code>,
<code>TealDatasetConnector</code> and / or
<code>TealDataConnector</code>.</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>adsl <span class="ot">&lt;-</span> <span class="fu">scda_cdisc_dataset_connector</span>(<span class="st">&quot;ADSL&quot;</span>, <span class="st">&quot;adsl&quot;</span>)</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>adae <span class="ot">&lt;-</span> <span class="fu">scda_cdisc_dataset_connector</span>(<span class="st">&quot;ADAE&quot;</span>, <span class="st">&quot;adae&quot;</span>)</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>advs <span class="ot">&lt;-</span> <span class="fu">scda_cdisc_dataset_connector</span>(<span class="st">&quot;ADVS&quot;</span>, <span class="st">&quot;advs&quot;</span>)</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>adtte <span class="ot">&lt;-</span> <span class="fu">scda_cdisc_dataset_connector</span>(<span class="st">&quot;ADTTE&quot;</span>, <span class="st">&quot;adtte&quot;</span>)</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">cdisc_data</span>(adsl, adae, advs, adtte)</span></code></pre></div>
<p><code>TealData</code> also contains a <code>launch()</code> method to
investigate if data is set correctly. However, <code>TealData</code>
lacks the <code>pull()</code> method.</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">interactive</span>()) {</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>  data<span class="sc">$</span><span class="fu">launch</span>()</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Reproducible code attached to the <code>data</code> object is
combined code of all components, but one can also extract code from
single dataset by specifying <code>dataname</code> argument.</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">get_code</span>(data)</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;ADSL &lt;- scda::synthetic_cdisc_dataset(dataset_name = \&quot;adsl\&quot;, name = \&quot;latest\&quot;)\nADAE &lt;- scda::synthetic_cdisc_dataset(dataset_name = \&quot;adae\&quot;, name = \&quot;latest\&quot;)\nADVS &lt;- scda::synthetic_cdisc_dataset(dataset_name = \&quot;advs\&quot;, name = \&quot;latest\&quot;)\nADTTE &lt;- scda::synthetic_cdisc_dataset(dataset_name = \&quot;adtte\&quot;, name = \&quot;latest\&quot;)&quot;</span></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a><span class="fu">get_code</span>(data, <span class="at">dataname =</span> <span class="st">&quot;ADSL&quot;</span>)</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;ADSL &lt;- scda::synthetic_cdisc_dataset(dataset_name = \&quot;adsl\&quot;, name = \&quot;latest\&quot;)&quot;</span></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a><span class="fu">get_code</span>(data, <span class="at">dataname =</span> <span class="st">&quot;ADTTE&quot;</span>)</span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;ADTTE &lt;- scda::synthetic_cdisc_dataset(dataset_name = \&quot;adtte\&quot;, name = \&quot;latest\&quot;)&quot;</span></span></code></pre></div>
<p>Developers can also extract datasets and connectors included in the
<code>TealData</code>.</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co"># if you launched the shiny app and pressed the submit button above to load the data,</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="co"># then these 4 lines do not need to be run</span></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>adsl<span class="sc">$</span><span class="fu">pull</span>()</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>adae<span class="sc">$</span><span class="fu">pull</span>()</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>advs<span class="sc">$</span><span class="fu">pull</span>()</span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>adtte<span class="sc">$</span><span class="fu">pull</span>()</span></code></pre></div>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co"># get loaded datasets</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span><span class="fu">get_datasets</span>()</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a><span class="co"># get single dataset</span></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span><span class="fu">get_dataset</span>(<span class="at">dataname =</span> <span class="st">&quot;ADSL&quot;</span>)</span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a><span class="co"># get data and dataset connectors</span></span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span><span class="fu">get_connectors</span>()</span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a><span class="co"># get all datasets/connectors</span></span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span><span class="fu">get_items</span>()</span></code></pre></div>
</div>
<div id="data-modification" class="section level3">
<h3>Data modification</h3>
<p>To modify a single dataset one should use <code>mutate_dataset</code>
by specifying <code>code</code> argument with code as a single character
or <code>script</code> with location of the script file. In the case of
delayed data, the pre-processing code passed into
<code>mutate_dataset</code> would be run after the data becomes
available.</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>adsl <span class="ot">&lt;-</span> <span class="fu">cdisc_dataset</span>(</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">dataname =</span> <span class="st">&quot;ADSL&quot;</span>,</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">synthetic_cdisc_dataset</span>(<span class="at">dataset_name =</span> <span class="st">&quot;adsl&quot;</span>, <span class="at">name =</span> <span class="st">&quot;latest&quot;</span>),</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">code =</span> <span class="st">&quot;ADSL &lt;- synthetic_cdisc_dataset(dataset_name = </span><span class="sc">\&quot;</span><span class="st">adsl</span><span class="sc">\&quot;</span><span class="st">, name = </span><span class="sc">\&quot;</span><span class="st">latest</span><span class="sc">\&quot;</span><span class="st">)&quot;</span></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_dataset</span>(<span class="at">code =</span> <span class="st">&quot;ADSL$x1 &lt;- 1&quot;</span>)</span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a>adtte <span class="ot">&lt;-</span> <span class="fu">scda_cdisc_dataset_connector</span>(</span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">dataname =</span> <span class="st">&quot;ADTTE&quot;</span>, <span class="st">&quot;adtte&quot;</span></span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_dataset</span>(<span class="at">code =</span> <span class="st">&quot;ADTTE$x2 &lt;- 2&quot;</span>)</span></code></pre></div>
<p><code>get_code()</code> function returns loading code from
<code>CallableFunction</code> and mutation code as provided in using
<code>mutate_dataset</code>.</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">get_code</span>(adsl))</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ADSL &lt;- synthetic_cdisc_dataset(dataset_name = &quot;adsl&quot;, name = &quot;latest&quot;)</span></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ADSL$x1 &lt;- 1</span></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">get_code</span>(adtte))</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ADTTE &lt;- scda::synthetic_cdisc_dataset(dataset_name = &quot;adtte&quot;, name = &quot;latest&quot;)</span></span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ADTTE$x2 &lt;- 2</span></span></code></pre></div>
<p><code>mutate_dataset</code> can also be used on <code>TealData</code>
objects which applies the <code>code</code> to the dataset specified in
<code>dataname</code>. This is important, as <code>TealData</code> can
track each call which affects this particular dataset. Check the code
below, where we create data containing two datasets using the
<code>cdisc_data</code> function. We can still use
<code>mutate_dataset</code> on the object which contains multiple
datasets, with one requirement - one needs to specify
<code>dataname</code>. Afterwards, one can extract reproducible code
from data which affects this particular <code>dataname</code>.</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">cdisc_data</span>(adsl, adtte) <span class="sc">%&gt;%</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_dataset</span>(<span class="at">code =</span> <span class="st">&quot;ADSL$x3 &lt;- 3&quot;</span>, <span class="at">dataname =</span> <span class="st">&quot;ADSL&quot;</span>)</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a><span class="co"># get reproducible code of all datasets</span></span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">get_code</span>(data))</span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ADSL &lt;- synthetic_cdisc_dataset(dataset_name = &quot;adsl&quot;, name = &quot;latest&quot;)</span></span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ADSL$x1 &lt;- 1</span></span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ADTTE &lt;- scda::synthetic_cdisc_dataset(dataset_name = &quot;adtte&quot;, name = &quot;latest&quot;)</span></span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ADTTE$x2 &lt;- 2</span></span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ADSL$x3 &lt;- 3</span></span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true" tabindex="-1"></a><span class="co"># get ADSL reproducible code</span></span>
<span id="cb25-13"><a href="#cb25-13" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">get_code</span>(data, <span class="at">dataname =</span> <span class="st">&quot;ADSL&quot;</span>))</span>
<span id="cb25-14"><a href="#cb25-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ADSL &lt;- synthetic_cdisc_dataset(dataset_name = &quot;adsl&quot;, name = &quot;latest&quot;)</span></span>
<span id="cb25-15"><a href="#cb25-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ADSL$x1 &lt;- 1</span></span>
<span id="cb25-16"><a href="#cb25-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ADSL$x3 &lt;- 3</span></span></code></pre></div>
<p>One can also pipe multiple <code>mutate_dataset</code> calls applied
on different datasets.</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">mutate_dataset</span>(data, <span class="at">code =</span> <span class="st">&quot;ADTTE$x4 &lt;- 4&quot;</span>, <span class="at">dataname =</span> <span class="st">&quot;ADTTE&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_dataset</span>(<span class="at">code =</span> <span class="st">&quot;ADSL &lt;- dplyr::filter(ADSL, SEX == &#39;F&#39;)&quot;</span>, <span class="at">dataname =</span> <span class="st">&quot;ADSL&quot;</span>)</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">get_code</span>(data, <span class="st">&quot;ADSL&quot;</span>))</span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ADSL &lt;- synthetic_cdisc_dataset(dataset_name = &quot;adsl&quot;, name = &quot;latest&quot;)</span></span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ADSL$x1 &lt;- 1</span></span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ADSL$x3 &lt;- 3</span></span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ADSL &lt;- dplyr::filter(ADSL, SEX == &quot;F&quot;)</span></span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a><span class="co"># note that the code for ADTTE below does not contain any mention of ADSL</span></span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">get_code</span>(data, <span class="st">&quot;ADTTE&quot;</span>))</span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ADTTE &lt;- scda::synthetic_cdisc_dataset(dataset_name = &quot;adtte&quot;, name = &quot;latest&quot;)</span></span>
<span id="cb26-12"><a href="#cb26-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ADTTE$x2 &lt;- 2</span></span>
<span id="cb26-13"><a href="#cb26-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ADTTE$x4 &lt;- 4</span></span></code></pre></div>
<p>Sometimes code of one object can depend on another, in this case we
can link them in the same way we link <code>TealDatasetConnector</code>
objects. If object code is dependent on another, as ADTTE depends on
ADSL below, <code>get_code</code> will return everything we need to be
executed to reproduce this dataset.</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">mutate_dataset</span>(</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>  data,</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">code =</span> <span class="st">&quot;ADTTE &lt;- filter(ADTTE, USUBJID %in% ADSL$USUBJID)&quot;</span>,</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">dataname =</span> <span class="st">&quot;ADTTE&quot;</span>,</span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">vars =</span> <span class="fu">list</span>(<span class="at">ADSL =</span> adsl) <span class="co"># vars = list(&lt;DATANAME&gt; = &lt;dataset name&gt;))</span></span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_dataset</span>(<span class="st">&quot;ADSL$var_created_after &lt;- NA&quot;</span>, <span class="at">dataname =</span> <span class="st">&quot;ADSL&quot;</span>)</span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a><span class="co"># note that the code that defines ADSL is now part of the code of ADTTE below</span></span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">get_code</span>(data, <span class="at">dataname =</span> <span class="st">&quot;ADTTE&quot;</span>))</span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ADSL &lt;- synthetic_cdisc_dataset(dataset_name = &quot;adsl&quot;, name = &quot;latest&quot;)</span></span>
<span id="cb27-12"><a href="#cb27-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ADSL$x1 &lt;- 1</span></span>
<span id="cb27-13"><a href="#cb27-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ADTTE &lt;- scda::synthetic_cdisc_dataset(dataset_name = &quot;adtte&quot;, name = &quot;latest&quot;)</span></span>
<span id="cb27-14"><a href="#cb27-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ADTTE$x2 &lt;- 2</span></span>
<span id="cb27-15"><a href="#cb27-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ADSL$x3 &lt;- 3</span></span>
<span id="cb27-16"><a href="#cb27-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ADTTE$x4 &lt;- 4</span></span>
<span id="cb27-17"><a href="#cb27-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ADSL &lt;- dplyr::filter(ADSL, SEX == &quot;F&quot;)</span></span>
<span id="cb27-18"><a href="#cb27-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ADTTE &lt;- filter(ADTTE, USUBJID %in% ADSL$USUBJID)</span></span>
<span id="cb27-19"><a href="#cb27-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-20"><a href="#cb27-20" aria-hidden="true" tabindex="-1"></a><span class="co"># moreover, note that the code inserted to the mutate_dataset after the pipe was not included.</span></span></code></pre></div>
<p>Using <code>mutate_dataset</code> creates a tree of calls, which can
be subset by <code>dataname</code>, but developers can also use
<code>mutate_data</code> function which doesn’t require
<code>dataname</code> to be specified. When <code>mutate_data</code> is
used, code for a single dataset is not possible to be subset, instead
code of all datasets is returned.</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">mutate_data</span>(data,</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">code =</span> <span class="st">&quot;</span></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a><span class="st">    ADSL$x3 &lt;- 3</span></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a><span class="st">    proxy_var &lt;- 4</span></span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a><span class="st">    ADTTE$x4 &lt;- proxy_var</span></span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a><span class="st">  &quot;</span></span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a><span class="co"># single dataset code is not possible to obtain anymore</span></span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(adsl_code <span class="ot">&lt;-</span> <span class="fu">get_code</span>(data, <span class="st">&quot;ADSL&quot;</span>))</span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ADSL &lt;- synthetic_cdisc_dataset(dataset_name = &quot;adsl&quot;, name = &quot;latest&quot;)</span></span>
<span id="cb28-12"><a href="#cb28-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ADSL$x1 &lt;- 1</span></span>
<span id="cb28-13"><a href="#cb28-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ADTTE &lt;- scda::synthetic_cdisc_dataset(dataset_name = &quot;adtte&quot;, name = &quot;latest&quot;)</span></span>
<span id="cb28-14"><a href="#cb28-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ADTTE$x2 &lt;- 2</span></span>
<span id="cb28-15"><a href="#cb28-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ADSL$x3 &lt;- 3</span></span>
<span id="cb28-16"><a href="#cb28-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ADTTE$x4 &lt;- 4</span></span>
<span id="cb28-17"><a href="#cb28-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ADSL &lt;- dplyr::filter(ADSL, SEX == &quot;F&quot;)</span></span>
<span id="cb28-18"><a href="#cb28-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ADTTE &lt;- filter(ADTTE, USUBJID %in% ADSL$USUBJID)</span></span>
<span id="cb28-19"><a href="#cb28-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ADSL$var_created_after &lt;- NA</span></span>
<span id="cb28-20"><a href="#cb28-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ADSL$x3 &lt;- 3</span></span>
<span id="cb28-21"><a href="#cb28-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; proxy_var &lt;- 4</span></span>
<span id="cb28-22"><a href="#cb28-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ADTTE$x4 &lt;- proxy_var</span></span>
<span id="cb28-23"><a href="#cb28-23" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(adtte_code <span class="ot">&lt;-</span> <span class="fu">get_code</span>(data, <span class="st">&quot;ADTTE&quot;</span>))</span>
<span id="cb28-24"><a href="#cb28-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ADSL &lt;- synthetic_cdisc_dataset(dataset_name = &quot;adsl&quot;, name = &quot;latest&quot;)</span></span>
<span id="cb28-25"><a href="#cb28-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ADSL$x1 &lt;- 1</span></span>
<span id="cb28-26"><a href="#cb28-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ADTTE &lt;- scda::synthetic_cdisc_dataset(dataset_name = &quot;adtte&quot;, name = &quot;latest&quot;)</span></span>
<span id="cb28-27"><a href="#cb28-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ADTTE$x2 &lt;- 2</span></span>
<span id="cb28-28"><a href="#cb28-28" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ADSL$x3 &lt;- 3</span></span>
<span id="cb28-29"><a href="#cb28-29" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ADTTE$x4 &lt;- 4</span></span>
<span id="cb28-30"><a href="#cb28-30" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ADSL &lt;- dplyr::filter(ADSL, SEX == &quot;F&quot;)</span></span>
<span id="cb28-31"><a href="#cb28-31" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ADTTE &lt;- filter(ADTTE, USUBJID %in% ADSL$USUBJID)</span></span>
<span id="cb28-32"><a href="#cb28-32" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ADSL$var_created_after &lt;- NA</span></span>
<span id="cb28-33"><a href="#cb28-33" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ADSL$x3 &lt;- 3</span></span>
<span id="cb28-34"><a href="#cb28-34" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; proxy_var &lt;- 4</span></span>
<span id="cb28-35"><a href="#cb28-35" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ADTTE$x4 &lt;- proxy_var</span></span>
<span id="cb28-36"><a href="#cb28-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-37"><a href="#cb28-37" aria-hidden="true" tabindex="-1"></a><span class="co"># TRUE</span></span>
<span id="cb28-38"><a href="#cb28-38" aria-hidden="true" tabindex="-1"></a><span class="fu">as.character</span>(adsl_code) <span class="sc">==</span> <span class="fu">as.character</span>(adtte_code)</span>
<span id="cb28-39"><a href="#cb28-39" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] TRUE</span></span></code></pre></div>
</div>
<div id="teal.data-in-a-shiny-app" class="section level3">
<h3><code>teal.data</code> in a shiny app</h3>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>adsl <span class="ot">&lt;-</span> <span class="fu">scda_cdisc_dataset_connector</span>(<span class="st">&quot;ADSL&quot;</span>, <span class="st">&quot;adsl&quot;</span>)</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>adrs <span class="ot">&lt;-</span> <span class="fu">scda_cdisc_dataset_connector</span>(<span class="st">&quot;ADRS&quot;</span>, <span class="st">&quot;adrs&quot;</span>)</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">dataset</span>(<span class="st">&quot;x&quot;</span>, <span class="fu">data.frame</span>(<span class="at">x =</span> <span class="dv">1</span>, <span class="at">b =</span> <span class="dv">2</span>), <span class="at">code =</span> <span class="st">&quot;x &lt;- data.frame(x = 1, b = 2)&quot;</span>)</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">teal_data</span>(adsl, adrs, x)</span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a><span class="fu">shinyApp</span>(</span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">ui =</span> <span class="fu">fluidPage</span>(</span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a>    shinyjs<span class="sc">::</span><span class="fu">useShinyjs</span>(),</span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">titlePanel</span>(<span class="st">&quot;Delayed data loading&quot;</span>),</span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">sidebarLayout</span>(</span>
<span id="cb29-12"><a href="#cb29-12" aria-hidden="true" tabindex="-1"></a>      <span class="fu">sidebarPanel</span>(data<span class="sc">$</span><span class="fu">get_ui</span>(<span class="st">&quot;data&quot;</span>), <span class="fu">uiOutput</span>(<span class="st">&quot;dataset&quot;</span>)),</span>
<span id="cb29-13"><a href="#cb29-13" aria-hidden="true" tabindex="-1"></a>      <span class="fu">mainPanel</span>(<span class="fu">tableOutput</span>(<span class="st">&quot;dist_plot&quot;</span>))</span>
<span id="cb29-14"><a href="#cb29-14" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb29-15"><a href="#cb29-15" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb29-16"><a href="#cb29-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">server =</span> <span class="cf">function</span>(input, output, session) {</span>
<span id="cb29-17"><a href="#cb29-17" aria-hidden="true" tabindex="-1"></a>    data_reactive <span class="ot">&lt;-</span> data<span class="sc">$</span><span class="fu">get_server</span>()(<span class="st">&quot;data&quot;</span>)</span>
<span id="cb29-18"><a href="#cb29-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">observeEvent</span>(<span class="fu">data_reactive</span>(), <span class="at">ignoreNULL =</span> <span class="cn">TRUE</span>, {</span>
<span id="cb29-19"><a href="#cb29-19" aria-hidden="true" tabindex="-1"></a>      shinyjs<span class="sc">::</span><span class="fu">hide</span>(<span class="st">&quot;data-delayed_data&quot;</span>)</span>
<span id="cb29-20"><a href="#cb29-20" aria-hidden="true" tabindex="-1"></a>    })</span>
<span id="cb29-21"><a href="#cb29-21" aria-hidden="true" tabindex="-1"></a>    output<span class="sc">$</span>dataset <span class="ot">&lt;-</span> <span class="fu">renderUI</span>({</span>
<span id="cb29-22"><a href="#cb29-22" aria-hidden="true" tabindex="-1"></a>      <span class="fu">req</span>(<span class="fu">data_reactive</span>())</span>
<span id="cb29-23"><a href="#cb29-23" aria-hidden="true" tabindex="-1"></a>      datanames <span class="ot">&lt;-</span> <span class="fu">names</span>(<span class="fu">get_raw_data</span>(<span class="fu">data_reactive</span>()))</span>
<span id="cb29-24"><a href="#cb29-24" aria-hidden="true" tabindex="-1"></a>      <span class="fu">radioButtons</span>(<span class="st">&quot;dataname&quot;</span>, <span class="st">&quot;Select dataname&quot;</span>, datanames, datanames[<span class="dv">1</span>])</span>
<span id="cb29-25"><a href="#cb29-25" aria-hidden="true" tabindex="-1"></a>    })</span>
<span id="cb29-26"><a href="#cb29-26" aria-hidden="true" tabindex="-1"></a>    output<span class="sc">$</span>dist_plot <span class="ot">&lt;-</span> <span class="fu">renderTable</span>({</span>
<span id="cb29-27"><a href="#cb29-27" aria-hidden="true" tabindex="-1"></a>      <span class="fu">req</span>(input<span class="sc">$</span>dataname)</span>
<span id="cb29-28"><a href="#cb29-28" aria-hidden="true" tabindex="-1"></a>      dataset <span class="ot">&lt;-</span> <span class="fu">get_raw_data</span>(<span class="fu">data_reactive</span>())[[input<span class="sc">$</span>dataname]]</span>
<span id="cb29-29"><a href="#cb29-29" aria-hidden="true" tabindex="-1"></a>      <span class="fu">head</span>(dataset)</span>
<span id="cb29-30"><a href="#cb29-30" aria-hidden="true" tabindex="-1"></a>    })</span>
<span id="cb29-31"><a href="#cb29-31" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb29-32"><a href="#cb29-32" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<p><div style="width: 100% ; height: 400px ; text-align: center; box-sizing: border-box; -moz-box-sizing: border-box; -webkit-box-sizing: border-box;" class="muted well">Shiny applications not supported in static R Markdown documents</div></p>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
